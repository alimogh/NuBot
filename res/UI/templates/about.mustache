

<body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">NuBot</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/">Operation</a></li>
            <li><a href="/configui">Configuration</a></li>
            <li><a href="/setup">Setup</a></li>
            <li class="active"><a href="/about">About</a></li>
          </ul>

        </div><!--/.nav-collapse -->
      </div>
    </nav>


    <div class="container">


<div class="row">

  <link rel="icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEACABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAKCgr/FRUX/xYWGP8YGBr/GRkb/xsbHP8dHR7/Hh4f/x4eIP8fHyD/ICAh/yMjJP8kJCX/JiYo/ygoKv8pKSr/LCwu/y0tLv80NDT/QUFC/0ZGR/9MTE7/UFBR/1JSUv9bW1v/XFxc/2BgYP9hYWP/aGhp/2xsbP9ycnL/d3d3/3l5e/98fHz/f3+A/2dn/P9z3a//cNX8/4CAgP+Xl5f/nZ2e/56en/+fn5//n5+h/6amp/+rq6v/rKys/7CvsP+zs7T/uLi5/7u7u/+8vLz/wMDA/8fHx//Kysr/zc3N/9HR0f/d3d3/3t7e/+Xl5f/q6ur/6+vr/+3t7f/z8/P/9fX1//b29v/39/f/+Pj4//n5+f/6+vr/+/v7//z8/P/9/f3//v7+//////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/NCYmJiYmJiYmJiYmJiYmNCZKSkpKSkpKSkpKSkpKSiYmSkpKRisdRkMbMklKSkomJkpKSSEiNUhEEQwpSUpKJiZKSi8LHhhAPAwBDDZKSiYmSkoWACA7SEc6HAEaSkomJkpKBxI/SkpKSj4ICkpKJiZKSgUTR0pKSkpGDwZKSiYmSkoTED1KSkpKOQQVSkomJkpKKgowMy4sNycIMUpKJiZKSkEZDgkDAgsNH0VKSiYmSkpKQigUBgkXLUhKSkomJkpKSkpKSkpKSkpKSkpKJiYmJiYmJiYmJiYmJiYmJiYmIyUkNDQ0NDQ0NDQ0NDQmOCYmJiYmJiYmJiYmJiYmOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=" />



</head>

  <div class="page">
    <div class="preview-page">
    <div class="container">
      <div class="repository-with-sidebar repo-container with-full-navigation">

        
          <div class="repository-content context-loader-container">
            <div id="readme" class="boxed-group flush clearfix announce instapaper_body md">
              
                <h3>
                  <span class="octicon octicon-book"></span>
                  README.md
                </h3>
              
              <div class="markdown-body entry-content">
                <p><a href="https://camo.githubusercontent.com/6440f15c43c606d89df44bb6708ee64f17112b49/68747470733a2f2f627974656275636b65742e6f72672f4a6f7264616e4c6565506565727368617265732f6e75626f7474726164696e672f7261772f666161336135656262623438333337326531373665346138383231643738333563326434303466642f726561646d652d6173736574732f6c6f676f2e706e67" target="_blank"><img src="https://camo.githubusercontent.com/6440f15c43c606d89df44bb6708ee64f17112b49/68747470733a2f2f627974656275636b65742e6f72672f4a6f7264616e4c6565506565727368617265732f6e75626f7474726164696e672f7261772f666161336135656262623438333337326531373665346138383231643738333563326434303466642f726561646d652d6173736574732f6c6f676f2e706e67" width=180 height=100 alt="NuBot Logo" data-canonical-src="https://bytebucket.org/JordanLeePeershares/nubottrading/raw/faa3a5ebbb483372e176e4a8821d7835c2d404fd/readme-assets/logo.png" style="max-width:100%;"></a></p>

<h5>
<a id="user-content-official-automated-trading-bot-for-nubits-custodians" class="anchor" href="#official-automated-trading-bot-for-nubits-custodians" aria-hidden="true"><span class="octicon octicon-link"></span></a>Official automated trading bot for NuBits custodians</h5>

<p><em>Disclaimer : this documentation is currently under-development and is therefore subject to sudden changes</em></p>

<h1>
<a id="user-content-what-is-nubot" class="anchor" href="#what-is-nubot" aria-hidden="true"><span class="octicon octicon-link"></span></a>What is NuBot?</h1>

<p>NuBot is a cross-platform automated trading bot written in java.
NuBot is a tool that helps <a href="https://www.nubits.com">NuBits</a> custodians to automate trades.
As explained in the <a href="https://nubits.com/about/white-paper">white paper</a>, a custodian's core mission is to <strong>help maintain the peg while introducing new currency into the market</strong>.</p>

<p><a href="http://discuss.nubits.com/category/nubits/automated-trading">Discuss NuBot with the community</a></p>

<h1>
<a id="user-content-changelog" class="anchor" href="#changelog" aria-hidden="true"><span class="octicon octicon-link"></span></a>Changelog</h1>

<p>See <a href="https://bitbucket.org/JordanLeePeershares/nubottrading/src/5ef7ead8a435ef0e142dc07de3a0405569da0ecc/CHANGELOG.md?at=master">CHANGELOG.md</a></p>

<h1>
<a id="user-content-how-does-it-work" class="anchor" href="#how-does-it-work" aria-hidden="true"><span class="octicon octicon-link"></span></a>How does it work?</h1>

<p>Only custodians will use the trading bot and relay liquidity data to other Nu clients.
Within the Nu system there are two types of custodians: <strong>sell side</strong> and <strong>dual side</strong> custodians.
<em>Dual side custodians</em> are custodians whose specific function is to provide liquidity for compensation, and they will initially only provide buy side price support. Once their buy order for NBT is partially filled, the bot should then create a sell order for that NBT.
In the case of <em>sell side custodians</em>, the liquidity they provide is secondary to another goal such as funding core development, marketing NBT or distributing Peercoin dividends. They want to spend the proceeds of their NBT, so under no circumstance will they provide buy side liquidity.
NuBot permits a user to indicate they are either a sell side or dual side custodian. This effect the trading bots behavior is detailed in the use cases below.</p>

<h1>
<a id="user-content-using-nubot" class="anchor" href="#using-nubot" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using NuBot</h1>

<p>See <a href="https://bitbucket.org/JordanLeePeershares/nubottrading/src/d69252c90538a92acb0f40a0367f0a10a207719e/SETUP.md?at=master">SETUP.md</a></p>

<h2>
<a id="user-content-dual-side-strategy" class="anchor" href="#dual-side-strategy" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dual-side strategy</h2>

<p>First, someone who wishes to fulfill this role must seek shareholder approval via the custodial grant mechanism.
Say a particular liquidity provider or <em>LP</em> custodian has 10 million USD he wishes to use to provide NuBit liquidity. He would expect compensation for lost opportunity cost (he could otherwise invest those funds in rental property, stocks or bonds) and for the risk of loss via an exchange default, such as we have seen with Mt. Gox and others.
While the market will continually reprice this, let's say in our case the prospective LP custodian decides a 5% return every six months is fair compensation for lost opportunity cost and risk of exchange default. So, he promises shareholders to provide 10 million USD/NBT worth of liquidity for one year in exchange for 500,000 NBT. Shareholders approve this using the grant mechanism and he is granted 500,000 NBT. Now he must provide 10 million in liquidity constantly over the next year. He may do this through a single exchange or multiple exchanges.
Let's say he does this with a single exchange. He opens an account with the exchange, then deposits $10 million worth of BTC and exchanges the BTC for USD.
Now he is ready to make use of the trading bot.
An appropriate exchange will expose a trading API and our trading bot implements the API for that specific exchange. Each implementation of a specific exchange API implements an interface to standardize the way the trading bot interacts with these diverse exchange APIs.
Doing this will allow the LP custodian to enter authentication information into the trading bot for his exchange account. He will then use the user interface in our trading bot to place an buy order for 10,000,000 NBT on the exchange.
The price will not be exactly one USD, it will be one USD minus the exchange transaction fee. If the exchange charges a 0.2% transaction fee, he will place a buy order for 10,000,000 NBT at a price of 0.998 USD.
Let us suppose his order is partially filled in the amount of 1,000,000 NBT. Now his exchange account will contain 9,000,000 USD used to fund an order for 9,000,000 NBT. There will also be 1,000,000 NBT in the account. The trading bot automatically and immediately place these 1,000,000 NBT for sale at a price of 1.002 USD (one USD + a 0.2% transaction fee). If this order fills, then the bot should use the USD proceeds to immediately place a buy order for NBT at 0.998 USD. All funds should be continually on order and the LP custodian's funds should not be depleted by transaction fees.
When an order is placed, canceled or filled (even partially), the <em>liquidityinfo</em> RPC method is called in the Nu client.</p>

<p>See <a href="#markdown-header-dual-side-logic">Attached Diagrams</a> for a visual flowchart.</p>

<h2>
<a id="user-content-sell-side-strategy" class="anchor" href="#sell-side-strategy" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sell-side strategy</h2>

<p>In some cases custodians will spend the NuBits directly and not use the trading bot at all.
For instance, if core developers accept NuBits as compensation then Jordan Lee will simply distribute NuBits granted to him directly without the need for any exchange.
Let's examine the case where a 10,000,000 NBT custodial grant is given for the purpose of distributing a shareholder dividend in Peercoin.
Such a custodian will deposit 10,000,000 NBT in a single or multiple exchanges. In our use case we will use a single exchange. Once the NBT deposit is credited, the custodian will start the trading bot, indicate they are a sell side custodian and indicate that orders should be created, although nothing specific about the order should be entered by the user.
The trading bot should offer the entire balance of NBT for sale using the formula of one USD + transaction fee + one pricing increment.
Some exchanges allow the fee to be discovered through their API, while others do not. If the fee can be found through the API, it will. If not, the user should be asked to specify the transaction fee.
Let's say our exchange has a transaction fee of 0.2% and supports 4 decimal places in its order book on the NBT/USD pair. Using our formula above, the trading bot would place an sell order for 10,000,000 NBT at a price of 1.0021.
The reason it should be 1.0021 instead of 1.002 is that we want dual side sell orders to be executed first, so their funds can be returned to providing buy side liquidity.
Each time an order is placed, cancelled or filled (even partially), the <em>liquidityinfo</em> Nu client RPC method is called. Details about this method can be found in the Liquidity Pool Tracking section.
Calling <em>liquidityinfo</em> will have the effect of transmitting the size of the buy and sell liquidity pool the local trading bot is managing to all known Nu peers.</p>

<p>See <a href="#markdown-header-sell-side-logic">Attached Diagrams</a> for a visual flowchart.</p>

<h2>
<a id="user-content-other-strategies" class="anchor" href="#other-strategies" aria-hidden="true"><span class="octicon octicon-link"></span></a>Other strategies</h2>

<p>There might be adjusted versions of the two strategies explained above.
To request a custom build of NuBot to fulfil a particular custodial grant, <a href="http://discuss.nubits.com/category/nubits/automated-trading">get in touch</a>.</p>

<p>Alternative strategies  :</p>

<ul>
<li>
<em>Secondary Peg Strategy</em> : a strategy to let custodian trade of pairs different from NBT/USD .</li>
<li>
<em>KTms Strategy</em> : dual side Strategy with x% of proceeds from sales kept in balance. Link to <a href="http://discuss.nubits.com/t/proposal-to-operate-a-nubits-grant-to-provide-early-stage-dual-side-liquidity-and-shareholder-dividends/120/25">KTm's custodial proposal</a> .</li>
</ul>

<h1>
<a id="user-content-under-the-hood" class="anchor" href="#under-the-hood" aria-hidden="true"><span class="octicon octicon-link"></span></a>Under the hood</h1>

<h2>
<a id="user-content-adding-support-for-an-exchange" class="anchor" href="#adding-support-for-an-exchange" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding support for an exchange</h2>

<p><em>coming soon</em></p>

<h2>
<a id="user-content-design-and-diagrams" class="anchor" href="#design-and-diagrams" aria-hidden="true"><span class="octicon octicon-link"></span></a>Design and diagrams</h2>

<h3>
<a id="user-content-sell-side-logic" class="anchor" href="#sell-side-logic" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sell-side logic</h3>

<p><a href="https://camo.githubusercontent.com/a54ba078b58a4ccfc15695253f192cd005710da4/68747470733a2f2f627974656275636b65742e6f72672f4a6f7264616e4c6565506565727368617265732f6e75626f7474726164696e672f7261772f666161336135656262623438333337326531373665346138383231643738333563326434303466642f726561646d652d6173736574732f626f742d636173652d322e706e67" target="_blank"><img src="https://camo.githubusercontent.com/a54ba078b58a4ccfc15695253f192cd005710da4/68747470733a2f2f627974656275636b65742e6f72672f4a6f7264616e4c6565506565727368617265732f6e75626f7474726164696e672f7261772f666161336135656262623438333337326531373665346138383231643738333563326434303466642f726561646d652d6173736574732f626f742d636173652d322e706e67" alt="alt text" title="NuBot Sell-Side logic" data-canonical-src="https://bytebucket.org/JordanLeePeershares/nubottrading/raw/faa3a5ebbb483372e176e4a8821d7835c2d404fd/readme-assets/bot-case-2.png" style="max-width:100%;"></a></p>

<h3>
<a id="user-content-dual-side-logic" class="anchor" href="#dual-side-logic" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dual-side logic</h3>

<p><a href="https://camo.githubusercontent.com/2943d0c9fc88d138291baa426b375968d8970233/68747470733a2f2f627974656275636b65742e6f72672f4a6f7264616e4c6565506565727368617265732f6e75626f7474726164696e672f7261772f666161336135656262623438333337326531373665346138383231643738333563326434303466642f726561646d652d6173736574732f626f742d636173652d312e706e67" target="_blank"><img src="https://camo.githubusercontent.com/2943d0c9fc88d138291baa426b375968d8970233/68747470733a2f2f627974656275636b65742e6f72672f4a6f7264616e4c6565506565727368617265732f6e75626f7474726164696e672f7261772f666161336135656262623438333337326531373665346138383231643738333563326434303466642f726561646d652d6173736574732f626f742d636173652d312e706e67" alt="alt text" title="NuBot Dual-Side logic" data-canonical-src="https://bytebucket.org/JordanLeePeershares/nubottrading/raw/faa3a5ebbb483372e176e4a8821d7835c2d404fd/readme-assets/bot-case-1.png" style="max-width:100%;"></a></p>

<h2>
<a id="user-content-adding-ssl-certificates-for-an-exchange" class="anchor" href="#adding-ssl-certificates-for-an-exchange" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adding SSL certificates for an exchange</h2>

<p>In order for the bot to communicate with the exchanges API via encrypted https, it is necessary that the SSL certificate of the exchange is added to the local store of trusted certificates.
NuBot includes the keystore file in its build. The Java JVM uses this keystore, an encrypted file which contains a <a href="../master/NuBot/res/ssl/nubot_keystore.jks">file.jks</a> with a collection of authorised certificates.</p>

<p>Using the keytool we can create the keystore</p>

<pre><code>keytool -genkey -alias signFiles -keystore nubot_keystore.jks
</code></pre>

<p>You will be prompted to enter passwords for the key and keystore.</p>

<p>To add a certificate we first need to get the SSL certificate (usually .cer) from the Exchange.
An easy way is navigate with the browser to the API entry-point, click on the lock icon, and drag the certificate locally.
After that the certificate can be added to the bot using keytool:</p>

<pre><code>keytool -importcert -file certificate.cer -keystore nubot_keystore.jks -alias "certificate alias"
</code></pre>

<p>In the Java code we need to tell to the JVM which keystore to use (usually on startup)</p>

<div class="highlight highlight-java"><pre><span class="pl-stj">System</span><span class="pl-k">.</span>setProperty(<span class="pl-s1"><span class="pl-pds">"</span>javax.net.ssl.trustStore<span class="pl-pds">"</span></span>,<span class="pl-c1">KEYSTORE_FILE_PATH</span>);
<span class="pl-stj">System</span><span class="pl-k">.</span>setProperty(<span class="pl-s1"><span class="pl-pds">"</span>javax.net.ssl.trustStorePassword<span class="pl-pds">"</span></span>,<span class="pl-c1">KEYSTORE_PASSWORD</span>);</pre></div>

<p>To list all the certificates in a keystore</p>

<pre><code>keytool -list -v -keystore Nubot_keystore.jks
</code></pre>

<h2>
<a id="user-content-updating-the-latest-version-of-the-keystore" class="anchor" href="#updating-the-latest-version-of-the-keystore" aria-hidden="true"><span class="octicon octicon-link"></span></a>Updating the latest version of the keystore</h2>

<p>Exchanges tend to upgrade their SSL certificates multiple times per year, and you need to maintain the keystore up-to-date for security reasons. We are committed to keep the <em>java keystore</em> always updated with most recent certificates available in the develop branch of this repository. </p>

<p>For unix systems with, you can use the downloading script provided with the bot, and located under <code>res/ssl</code> (wget required) :  </p>

<pre><code>cd res/ssl
 ./updateKeystore.sh
</code></pre>

<p>Alternatively you can manually download the latest available download the most recent version from the repository: <a href="https://bitbucket.org/JordanLeePeershares/nubottrading/src/cfa0c7699ccd96300c1b1f77d416b9a6f1fa6e8d/NuBot/res/ssl/nubot_keystore.jks?at=develop">nubot_keystore.jks</a> and place it in the <em>res/ssl</em> folder of NuBot.</p>

<h1>
<a id="user-content-price-feeds" class="anchor" href="#price-feeds" aria-hidden="true"><span class="octicon octicon-link"></span></a>Price Feeds</h1>

<p>See <a href="https://bitbucket.org/JordanLeePeershares/nubottrading/src/5ef7ead8a435ef0e142dc07de3a0405569da0ecc/FEEDS.md?at=master">FEEDS.md</a></p>

<h1>
<a id="user-content-contribute" class="anchor" href="#contribute" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contribute</h1>

<p>See <a href="https://bitbucket.org/JordanLeePeershares/nubottrading/src/5ef7ead8a435ef0e142dc07de3a0405569da0ecc/CONTRIBUTE.md?at=master">CONTRIBUTE.md</a></p>

<h1>
<a id="user-content-license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h1>

<p>NuBot is released under <a href="https://bitbucket.org/JordanLeePeershares/nubottrading/src/5ef7ead8a435ef0e142dc07de3a0405569da0ecc/LICENSE.md?at=master">GNU GPL v2.0</a></p>

              </div>
            </div>
          </div>
        

      </div>
    </div>
  </div>
  <div>&nbsp;</div>
  </div><script>
    function showCanonicalImages() {
      var images = document.getElementsByTagName('img');
      if (!images) {
        return;
      }
      for (var index = 0; index < images.length; index++) {
        var image = images[index];
        if (image.getAttribute('data-canonical-src')) {
          image.src = image.getAttribute('data-canonical-src');
        }
      }
    }
    function scrollToHash() {
      if (location.hash && !document.querySelector(":target")) {
        var element = document.getElementById('user-content-' + location.hash.slice(1));
        if (element) {
           element.scrollIntoView();
        }
      }
    }
    window.onhashchange = function() {
      scrollToHash();
    }
    window.onload = function() {
      scrollToHash();
    }
    showCanonicalImages();
  </script>


</div>
